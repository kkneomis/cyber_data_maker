#/bin/bash

corpus='config/changeme/corpus.txt'

one=$(sort -R $corpus | head -n1 | cut -d ' ' -f -6 | sed 's/[^a-zA-Z0-9]//g')
two=$(sort -R $corpus | head -n1 | cut -d ' ' -f -6 | sed 's/[^a-zA-Z0-9]//g')
three=$(sort -R $corpus | head -n1 | cut -d ' ' -f -6 | sed 's/[^a-zA-Z0-9]//g')
four=$(sort -R $corpus | head -n1 | cut -d ' ' -f -6 | sed 's/[^a-zA-Z0-9]//g')

echo $one

echo $one | awk  '{ print $1}' | base64 > malware/key1.txt
zip "malware/key1.zip" malware/key1.txt
rm malware/key1.txt

echo $two | tr 'A-Za-z' 'N-ZA-Mn-za-m' | base64 > malware/key2.txt
zip -P $one "malware/key2.zip" malware/key2.txt
rm malware/key2.txt

echo -n "=" > key3.txt
echo $three  | tr 'A-Za-z' 'N-ZA-Mn-za-m' | base64 | rev >> malware/key3.txt
zip -P $two "malware/key3.zip" malware/key3.txt
rm malware/key3.txt

echo $four | rev | xxd -p | base64 > malware/key4.txt
zip -P $three "malware/key4.zip" malware/key4.txt
rm malware/key4.txt


mkdir output/malware
mv malware/*zip output/malware/
