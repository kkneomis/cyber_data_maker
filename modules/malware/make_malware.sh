#/bin/bash

corpus='config/changeme/default/corpus.txt'

one=$(sort -R $corpus | head -n1 | cut -d ' ' -f -6 | sed 's/[^a-zA-Z0-9]//g')
two=$(sort -R $corpus | head -n1 | cut -d ' ' -f -6 | sed 's/[^a-zA-Z0-9]//g')
three=$(sort -R $corpus | head -n1 | cut -d ' ' -f -6 | sed 's/[^a-zA-Z0-9]//g')
four=$(sort -R $corpus | head -n1 | cut -d ' ' -f -6 | sed 's/[^a-zA-Z0-9]//g')


echo $one | awk  '{ print $1}' | base64 > modules/malware/key1.txt
zip "modules/malware/key1.zip" modules/malware/key1.txt
rm modules/malware/key1.txt

echo $two | tr 'A-Za-z' 'N-ZA-Mn-za-m' | base64 > modules/malware/key2.txt
zip -P $one "modules/malware/key2.zip" modules/malware/key2.txt
rm modules/malware/key2.txt

echo -n "=" > modules/malware/key3.txt
echo $three  | tr 'A-Za-z' 'N-ZA-Mn-za-m' | base64 | rev >> modules/malware/key3.txt
zip -P $two "modules/malware/key3.zip" modules/malware/key3.txt
rm modules/malware/key3.txt

echo $four | rev | xxd -p | base64 > modules/malware/key4.txt
zip -P $three "modules/malware/key4.zip" modules/malware/key4.txt
rm modules/malware/key4.txt

mkdir output/malware
mv modules/malware/*zip output/malware/
